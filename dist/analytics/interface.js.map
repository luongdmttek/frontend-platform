{"version":3,"file":"interface.js","names":["PropTypes","optionsShape","config","object","isRequired","httpClient","oneOfType","func","loggingService","shape","logError","logInfo","serviceShape","sendTrackingLogEvent","identifyAuthenticatedUser","identifyAnonymousUser","sendTrackEvent","sendPageEvent","service","configure","AnalyticsService","options","checkPropTypes","eventName","properties","userId","traits","category","name","getAnalyticsService","Error","resetAnalyticsService"],"sources":["../../src/analytics/interface.js"],"sourcesContent":["/**\r\n * #### Import members from **@edx/frontend-platform/analytics**\r\n *\r\n * Contains a shared interface for tracking events.  Has a default implementation of\r\n * SegmentAnalyticsService, which supports Segment and the Tracking Log API (hosted in LMS).\r\n *\r\n * The `initialize` function performs much of the analytics configuration for you.  If, however,\r\n * you're not using the `initialize` function, analytics can be configured via:\r\n *\r\n * ```\r\n * import { configure, SegmentAnalyticsService } from '@edx/frontend-platform/analytics';\r\n * import { getConfig } from '@edx/frontend-platform';\r\n * import { getAuthenticatedHttpClient } from '@edx/frontend-platform/auth';\r\n * import { getLoggingService } from '@edx/frontend-platform/logging';\r\n *\r\n * configure(SegmentAnalyticsService, {\r\n *   config: getConfig(),\r\n *   loggingService: getLoggingService(),\r\n *   httpClient: getAuthenticatedHttpClient(),\r\n * });\r\n * ```\r\n *\r\n * As shown in this example, analytics depends on the configuration document, logging, and having\r\n * an authenticated HTTP client.\r\n *\r\n * @module Analytics\r\n */\r\nimport PropTypes from 'prop-types';\r\n\r\nconst optionsShape = {\r\n  config: PropTypes.object.isRequired,\r\n  httpClient: PropTypes.oneOfType([PropTypes.func, PropTypes.object]).isRequired,\r\n  loggingService: PropTypes.shape({\r\n    logError: PropTypes.func.isRequired,\r\n    logInfo: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n};\r\n\r\nconst serviceShape = {\r\n  sendTrackingLogEvent: PropTypes.func.isRequired,\r\n  identifyAuthenticatedUser: PropTypes.func.isRequired,\r\n  identifyAnonymousUser: PropTypes.func.isRequired,\r\n  sendTrackEvent: PropTypes.func.isRequired,\r\n  sendPageEvent: PropTypes.func.isRequired,\r\n};\r\n\r\nlet service;\r\n\r\n/**\r\n *\r\n * @param {class} AnalyticsService\r\n * @param {*} options\r\n * @returns {AnalyticsService}\r\n */\r\nexport function configure(AnalyticsService, options) {\r\n  PropTypes.checkPropTypes(optionsShape, options, 'property', 'Analytics');\r\n  service = new AnalyticsService(options);\r\n  PropTypes.checkPropTypes(serviceShape, service, 'property', 'AnalyticsService');\r\n  return service;\r\n}\r\n\r\n/**\r\n *\r\n * @param {*} eventName\r\n * @param {*} properties\r\n * @returns {Promise}\r\n */\r\nexport function sendTrackingLogEvent(eventName, properties) {\r\n  return service.sendTrackingLogEvent(eventName, properties);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n * @param {*} userId\r\n * @param {*} traits\r\n */\r\nexport function identifyAuthenticatedUser(userId, traits) {\r\n  service.identifyAuthenticatedUser(userId, traits);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n * @param {*} traits\r\n * @returns {Promise}\r\n */\r\nexport function identifyAnonymousUser(traits) {\r\n  return service.identifyAnonymousUser(traits);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n * @param {*} eventName\r\n * @param {*} properties\r\n */\r\nexport function sendTrackEvent(eventName, properties) {\r\n  service.sendTrackEvent(eventName, properties);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n * @param {*} category\r\n * @param {*} name\r\n * @param {*} properties\r\n */\r\nexport function sendPageEvent(category, name, properties) {\r\n  service.sendPageEvent(category, name, properties);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n * @returns {AnalyticsService}\r\n */\r\nexport function getAnalyticsService() {\r\n  if (!service) {\r\n    throw Error('You must first configure the analytics service.');\r\n  }\r\n\r\n  return service;\r\n}\r\n\r\n/**\r\n *\r\n */\r\nexport function resetAnalyticsService() {\r\n  service = null;\r\n}\r\n\r\n/**\r\n * @name AnalyticsService\r\n * @interface\r\n * @memberof module:Analytics\r\n * @property {function} identifyAnonymousUser\r\n * @property {function} identifyAuthenticatedUser\r\n * @property {function} sendPageEvent\r\n * @property {function} sendTrackEvent\r\n * @property {function} sendTrackingLogEvent\r\n */\r\n"],"mappings":"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"}