{"version":3,"file":"AppProvider.js","names":["React","useState","useMemo","PropTypes","BrowserRouter","Router","OptionalReduxProvider","ErrorBoundary","AppContext","useAppEvent","useTrackColorSchemeChoice","getAuthenticatedUser","AUTHENTICATED_USER_CHANGED","getConfig","CONFIG_CHANGED","getLocale","getMessages","IntlProvider","LOCALE_CHANGED","basename","AppProvider","_ref","store","children","wrapWithRouter","_useState","_useState2","_slicedToArray","config","setConfig","_useState3","_useState4","authenticatedUser","setAuthenticatedUser","_useState5","_useState6","locale","setLocale","appContextValue","createElement","messages","Provider","value","propTypes","object","node","isRequired","bool","defaultProps"],"sources":["../../src/react/AppProvider.jsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\n\r\nimport OptionalReduxProvider from './OptionalReduxProvider';\r\n\r\nimport ErrorBoundary from './ErrorBoundary';\r\nimport AppContext from './AppContext';\r\nimport { useAppEvent, useTrackColorSchemeChoice } from './hooks';\r\nimport { getAuthenticatedUser, AUTHENTICATED_USER_CHANGED } from '../auth';\r\nimport { getConfig } from '../config';\r\nimport { CONFIG_CHANGED } from '../constants';\r\nimport {\r\n  getLocale,\r\n  getMessages,\r\n  IntlProvider,\r\n  LOCALE_CHANGED,\r\n} from '../i18n';\r\nimport { basename } from '../initialize';\r\n\r\n/**\r\n * A wrapper component for React-based micro-frontends to initialize a number of common data/\r\n * context providers.\r\n *\r\n * ```\r\n * subscribe(APP_READY, () => {\r\n *   ReactDOM.render(\r\n *     <AppProvider>\r\n *       <HelloWorld />\r\n *     </AppProvider>\r\n *   )\r\n * });\r\n * ```\r\n *\r\n * This will provide the following to HelloWorld:\r\n * - An error boundary as described above.\r\n * - An `AppContext` provider for React context data.\r\n * - IntlProvider for @edx/frontend-i18n internationalization\r\n * - Optionally a redux `Provider`. Will only be included if a `store` property is passed to\r\n * `AppProvider`.\r\n * - A `Router` for react-router.\r\n *\r\n * @param {Object} props\r\n * @param {Object} [props.store] A redux store.\r\n * @memberof module:React\r\n */\r\nexport default function AppProvider({ store, children, wrapWithRouter }) {\r\n  const [config, setConfig] = useState(getConfig());\r\n  const [authenticatedUser, setAuthenticatedUser] = useState(getAuthenticatedUser());\r\n  const [locale, setLocale] = useState(getLocale());\r\n\r\n  useTrackColorSchemeChoice();\r\n\r\n  useAppEvent(AUTHENTICATED_USER_CHANGED, () => {\r\n    setAuthenticatedUser(getAuthenticatedUser());\r\n  });\r\n\r\n  useAppEvent(CONFIG_CHANGED, () => {\r\n    setConfig(getConfig());\r\n  });\r\n\r\n  useAppEvent(LOCALE_CHANGED, () => {\r\n    setLocale(getLocale());\r\n  });\r\n\r\n  const appContextValue = useMemo(() => ({ authenticatedUser, config, locale }), [authenticatedUser, config, locale]);\r\n\r\n  return (\r\n    <IntlProvider locale={locale} messages={getMessages()}>\r\n      <ErrorBoundary>\r\n        <AppContext.Provider\r\n          value={appContextValue}\r\n        >\r\n          <OptionalReduxProvider store={store}>\r\n            {wrapWithRouter ? (\r\n              <Router basename={basename}>\r\n                <div data-testid=\"browser-router\">\r\n                  {children}\r\n                </div>\r\n              </Router>\r\n            ) : children}\r\n          </OptionalReduxProvider>\r\n        </AppContext.Provider>\r\n      </ErrorBoundary>\r\n    </IntlProvider>\r\n  );\r\n}\r\n\r\nAppProvider.propTypes = {\r\n  // eslint-disable-next-line react/forbid-prop-types\r\n  store: PropTypes.object,\r\n  children: PropTypes.node.isRequired,\r\n  wrapWithRouter: PropTypes.bool,\r\n};\r\n\r\nAppProvider.defaultProps = {\r\n  store: null,\r\n  wrapWithRouter: true,\r\n};\r\n"],"mappings":"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","ignoreList":[]}